<!DOCTYPE html>
<html>
  <head>
    <title>The Ballot Book</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'https://js.stripe.com/v3/', 'data-turbolinks-track': 'reload' %>
    <link rel="stylesheet" href="https://cdn.datatables.net/searchpanes/1.1.1/css/searchPanes.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/select/1.3.1/css/select.dataTables.min.css">  
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/dataTables.bootstrap4.min.css"> 
    <script type="text/javascript" src="https://cdn.datatables.net/searchpanes/1.1.1/js/dataTables.searchPanes.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/select/1.3.1/js/dataTables.select.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.21/js/dataTables.bootstrap4.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <%= tag :meta, name: "stripe-key", content: Rails.application.credentials.stripe_publishable_key %>
    <%= favicon_link_tag asset_path('logos/ballot_logo_square.png'), :rel => 'icon', :type =>  'image/png' %>
  </head>

  <body class="bg-white">
  
    <% flash.each do |type, msg| %>
      <div class="alert alert-info">
        <%= msg %>
      </div>
    <% end %>
    <div class="container">


<% if user_signed_in? && current_user.subscribed?  %>
  <nav class="navbar navbar-expand-lg navbar-light bg-white">
      <a class="navbar-brand"><%= image_tag 'logos/ballot_logo_square.png', class: "logo" %></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav mr-auto">
              <li class="nav-item active">
                  <a class="nav-link" <%= link_to 'Home', page_path('home') %><span class="sr-only">(current)</span></a>
              </li>
              <li class="nav-item">
                  <a class="nav-link " href="/people/">People</a>
              </li>
              <li class="nav-item">
                  <a class="nav-link" href="/jurisdictions">Jurisdictions</a>
              </li>              
              <li class="nav-item">
                  <a class="nav-link" href="/districts">Districts</a>
              </li>
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href='' data-target="#navbarDropdown" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Campaign Finance
                  </a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/reports/">Campaign Finance Reports</a>
                    <a class="dropdown-item" href="/committees/">Committees</a>
                    <a class="dropdown-item" href="/expenditures/">Independent Expenditures</a>
                  </div>
                </li>
          </ul>

          <ul class="navbar-nav">  
          <li>
              <%= form_with url: search_path, local: true, method: :get, html: { class: "form-inline my-2 my-lg-0 mr-4" } do |form| %>
                <%= form.text_field :q, placeholder: "Search People...", data: { behavior: "autocomplete" }, class: " form-control mr-sm-2" %>
                <%= form.button "Search", class: "d-none" %>
              <% end %>
              </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href='' data-target="#navbarDropdown" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Hello, <%= current_user.first_name %>!
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="/users/edit">My Account</a>
              <a class="dropdown-item" href="/dashboard/">My Dashboard</a>
              <a class="dropdown-item" href="/users/sign_out">Log Out</a>
            </div>
           </li>
          </ul>  
          <%elsif user_signed_in? %>
          <nav class="navbar navbar-expand-md navbar-light bg-light">
            <a class="navbar-brand" href="#">Navbar</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <a class="nav-link" <%= link_to 'Home', page_path('home') %><span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="">About</a>
                    </li>
                </ul>
          <ul class="navbar-nav ">

              <li class="nav-item m-1">
                <%= link_to 'Account', edit_user_registration_path, class: "nav-link" %>
              </li>  
              <li class="nav-item m-1 mr-5">
                  <%= link_to 'Logout', destroy_user_session_path, method: :delete, :class => "btn" %>
              </li>
          </ul>

          <%else%>
          <nav class="navbar navbar-expand-md navbar-light bg-light">
            <a class="navbar-brand" href="#">Navbar</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <a class="nav-link" <%= link_to 'Home', page_path('home') %><span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="">About</a>
                    </li>
                </ul>
          <ul class="navbar-nav">
          

              <li class="nav-item m-1">
                  <%= link_to 'Pricing', pricing_index_path, class: 'btn btn-outline-secondary' %>
              </li> 
              <li class="nav-item m-1">
                  <%= link_to 'Subscribe', new_user_registration_path, :class => "btn btn-primary" %>
              </li>
              <li class="nav-item m-1">
                  <%= link_to 'Login', new_user_session_path, :class => "btn btn-outline-primary" %>
              </li>
            </ul>
            <%end%>
          
          </ul>
      </div>
  </nav>

</div>


<div class="container mt-4 rounded border-primary">
    
        
    

    <%= yield %>
    <br>
  </body>
  </div>
</html>
