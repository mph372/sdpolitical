<div class="container">
  <div class="row bg-light bg-white mt-1">

      <div class="col-md"><h1 class="heavy text-nowrap primary-blue"><%= @jurisdiction.name %> </h1></div>
        <div class="col-md  d-md-none float-left">
        <%= link_to "Jurisdiction Fundraising Report (PDF)", jurisdiction_path(@jurisdiction, format: "pdf"), :class => "btn btn-primary" %>
  </div>
    <div class="col-md  d-none d-md-table-cell text-right">
        <%= link_to "Jurisdiction Fundraising Report (PDF)", jurisdiction_path(@jurisdiction, format: "pdf"), :class => "float-right btn btn-primary ml-4" %>
  </div>

      
    </div> 
  </div>   

 
<hr>
<% if @jurisdiction.statistical_datum.present? %>
<div class="row">
    <div class="col">
      <%= render 'jurisdiction_data'%>
    </div>
</div>
<%end%>
<br>
<div class="card shadow-sm mb-3 bg-white rounded primary-border">
  <h5 class="card-header"> List of Offices & Districts </h5>
  <div class="table-responsive bg-white rounded border-primary ">
    <table class="table table-sm">
    <thead>
        <tr>
          <th class="pl-4 col-3">District</th>
          <th class="condensed-column col-1"></th>
          <th class=" col-3">Incumbent</th>
          <th class=" col-2">Term Expires</th>
          <th class="pr-4 col-3 "> <span class="float-right">Registration Advantage</span> </th>
          <th class="col-1"></th>
        </tr>
      </thead>

      <tbody> 
          <tr>
          <% @jurisdiction.districts.order(:district).each do |district| %>
            <td class="pl-4 col-3"><%= link_to "#{district.district_name}", district %></td>


                <% if district.person.present? %>
                  <% if district.person.image.url.present?%>
                  <td class=" col-1"><%= image_tag district.person.image.url(:headshot), alt: 'headshot', :class => "avatar shadow-sm", size: "45x45"  %></td>
                  <%else%>
                  <td class=" col-1"><%= image_tag 'blank-headshot.png', alt: 'headshot', :class => "avatar shadow-sm", size: "45x45"  %></td>
                  <%end%>
                <%else%>
                <td class=" col-1"><%= image_tag 'blank-headshot.png', alt: 'headshot', :class => "avatar shadow-sm", size: "45x45"  %></td>
                <%end%>

            <td class="col-3"><% if district.person.present? %>
                    <% if district.person.party == "Republican" %>
                    <%= link_to "#{district.person.first_name} #{district.person.last_name} #{district.person.party_abbreviation}", district.person, { :class =>"gop-text" }%>
                    <%elsif district.person.party == "Democrat"%>
                    <%= link_to "#{district.person.first_name} #{district.person.last_name} #{district.person.party_abbreviation}", district.person, { :class =>"dem-text" }%>
                    <%else%>
                    <%= link_to "#{district.person.first_name} #{district.person.last_name} #{district.person.party_abbreviation}", district.person, { :class =>"dts-text" }%>
                    <%end%>
                  <%else%>Vacant<%end%></td>
            <td class="col-2"><%= district.term_expires %>
            <td class=" col-3">
              
                <% if district.registration_advantage > 0 %>
                <span class="dem-text pr-4 float-right" >D +<%= number_with_precision(district.registration_advantage, precision: 2) %>%</span>
                <% else %>
                <span class="gop-text pr-4 float-right" >R +<%= number_with_precision(district.registration_advantage*-1, precision: 2) %>%</span>
                <%end%>

            </td> 
            <td  class="col-1"></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>  
<br>
<!--
<% if @jurisdiction.measures.present? %>
<hr>
<h5 class="dark-red-supporting heavy">Current Ballot Measures</h5>
<div class="container primary-border rounded p-3">
  
  <div class="table-responsive shadow-sm bg-white rounded border-primary p-4">
    <table class="table">
        <thead>
        <tr>
          <th>Measure</th>
          <th>Topic</th>
          <th>Type</th>
          <th>Origin</th>
          <th>Threshold</th>
        </tr>
      </thead>

      <tbody>
        <% @measures.each do |measure| %>
        <tr> 
          <td><%= link_to "Measure #{measure.letter}", measure %> </td>
          <td><%= measure.topic %></td>
          <td><%= measure.measure_type %></td>
          <td><%= measure.origin %></td>     
          <td><%= number_to_percentage(measure.threshold, precision: 2) %></td>                  
        </tr>
        <%end%>
      </tbody>
    </table>
  </div>
</div>
<%end%>
-->
<br>
<%= render 'former_offices' %>

<br>

<% if user_signed_in? && current_user.admin? %>
<div class="row my-3">
  <div class="col">
    <%= link_to 'Add Statistical Data', new_statistical_datum_path(:jurisdiction_id => @jurisdiction.id), :class => "btn btn-primary mr-2" %>  
    <%= link_to 'Add Registration Snapshot', new_registration_snapshot_path(:statistical_datum_id => StatisticalDatum.find_by(jurisdiction_id: @jurisdiction)), :class => "btn btn-primary mr-2" %>
    <%= link_to 'Add Campaign Finance', new_campaign_finance_module_path(:jurisdiction_id => @jurisdiction.id), :class => "btn btn-primary mr-2" %>        
    <%= link_to 'Edit', edit_jurisdiction_path(@jurisdiction), :class => "btn btn-outline-primary mr-2" %> 
    <%= link_to 'Delete Jurisdiction', @jurisdiction, method: :delete, data: { confirm: 'Are you sure?' }, :class => "btn btn-warning" %> 
  </div>
</div>
<%end%>


    
</div>

</div>
