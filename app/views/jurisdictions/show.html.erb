<div class="container">
  <div class="row bg-light shadow-sm bg-white rounded primary-border mt-1 p-3">
      <div class="row p-1 m-1">
        <h2 class="primary-blue heavy"><%= @jurisdiction.name %></h2>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-lg-5">
            <% if @jurisdiction.map_url.present?%>
            <%= render 'map' %>
            <%end%>
          </div>
          <div class="col-lg-7">
            <%= render 'data'%>
          </div>
        </div>
        </div>
    </div> 
  </div>   

 
<br>
<hr>
<% if @jurisdiction.registration_history.present? %>
<div class="row">
    <div class="col">
      <%= render 'registration_history'%>
    </div>
</div>
<%end%>
<br>
<div class="card shadow-sm mb-3 bg-white rounded primary-border">
  <h5 class="card-header"> List of Offices & Districts </h5>
  <div class="table-responsive bg-white rounded border-primary ">
    <table class="table table-sm">
    <thead>
        <tr>
          <th class="pl-4">District</th>
          <th class="condensed-column"></th>
          <th>Incumbent</th>
          <th>Term Expires</th>
          <th class="pr-4">Reg Advantage</th>
        </tr>
      </thead>

      <tbody> 
          <tr>
          <% @jurisdiction.districts.order(:district).each do |district| %>
            <td class="pl-4"><%= link_to "#{district.district_name}", district %></td>


                <% if district.person.present? %>
                <td class="condensed-column"><%= image_tag district.person.image.url(:headshot), alt: 'headshot', :class => "avatar shadow-sm", size: "45x45"  %></td>
                <%else%>
                <td class="condensed-column"><%= image_tag 'https://nex3.com/wp-content/uploads/2019/12/placeholder-headshot-300x300.png', alt: 'headshot', :class => "avatar shadow-sm", size: "45x45"  %></td>
                <%end%>

            <td><% if district.person.present? %>
                    <% if district.person.party == "Republican" %>
                    <%= link_to "#{district.person.first_name} #{district.person.last_name} #{district.person.party_abbreviation}", district.person, { :class =>"gop-text" }%>
                    <%elsif district.person.party == "Democrat"%>
                    <%= link_to "#{district.person.first_name} #{district.person.last_name} #{district.person.party_abbreviation}", district.person, { :class =>"dem-text" }%>
                    <%else%>
                    <%= link_to "#{district.person.first_name} #{district.person.last_name} #{district.person.party_abbreviation}", district.person, { :class =>"dts-text" }%>
                    <%end%>
                  <%else%>Vacant<%end%></td>
            <td><%= district.term_expires %>
            <td class="pr-4"><% if district.registration_advantage > 0 %>
                <span class="dem-text" >D +<%= number_with_precision(district.registration_advantage, precision: 2) %>%</span>
                <% else %>
                <span class="gop-text" >R +<%= number_with_precision(district.absolute_registration_advantage, precision: 2) %>%</span>
                <%end%>
            </td> 
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>  
<br>
<!--
<% if @jurisdiction.measures.present? %>
<hr>
<h5 class="dark-red-supporting heavy">Current Ballot Measures</h5>
<div class="container primary-border rounded p-3">
  
  <div class="table-responsive shadow-sm bg-white rounded border-primary p-4">
    <table class="table">
        <thead>
        <tr>
          <th>Measure</th>
          <th>Topic</th>
          <th>Type</th>
          <th>Origin</th>
          <th>Threshold</th>
        </tr>
      </thead>

      <tbody>
        <% @measures.each do |measure| %>
        <tr> 
          <td><%= link_to "Measure #{measure.letter}", measure %> </td>
          <td><%= measure.topic %></td>
          <td><%= measure.measure_type %></td>
          <td><%= measure.origin %></td>     
          <td><%= number_to_percentage(measure.threshold, precision: 2) %></td>                  
        </tr>
        <%end%>
      </tbody>
    </table>
  </div>
</div>
<%end%>
-->
<br>
<% if @jurisdiction.committees.present? && current_user.subscribed? %>
<%= render 'committees'%>
<br>
<%end%>


<div class="row">

  <%= link_to "Download Jurisdiction Fundraising Report (PDF)", jurisdiction_path(@jurisdiction, format: "pdf"), :class => "float-right btn btn-primary ml-4" %>

  <%= link_to 'Back', jurisdictions_path, :class => "float-right btn btn-outline-secondary text-right" %> 
</div>
<% if  current_user.admin? %>
<div class="row my-3">
  <div class="col">
    <%= link_to "Add District", new_district_path(:jurisdiction_id => @jurisdiction.id), :action => "new", :method => :get, :class => "btn btn-primary mr-2" %> 
    <%= link_to 'Add Statistical Data', new_statistical_datum_path(:jurisdiction_id => @jurisdiction.id), :class => "btn btn-primary mr-2" %>  
    <%= link_to 'Add Registration Snapshot', new_registration_snapshot_path(:statistical_datum_id => StatisticalDatum.find_by(jurisdiction_id: @jurisdiction)), :class => "btn btn-primary mr-2" %>
    <%= link_to 'Add Campaign Finance', new_campaign_finance_module_path(:jurisdiction_id => @jurisdiction.id), :class => "btn btn-primary mr-2" %>        
    <%= link_to 'Edit', edit_jurisdiction_path(@jurisdiction), :class => "btn btn-outline-primary mr-2" %> 
    <%= link_to 'Delete Jurisdiction', @jurisdiction, method: :delete, data: { confirm: 'Are you sure?' }, :class => "btn" %> 
  </div>
</div>
<%end%>


    
</div>

</div>
