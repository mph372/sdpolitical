<p id="notice"><%= notice %></p>

<h1>Contributors</h1>

<table class="table table-sm" id="contributors">
  <thead>
    <tr>
      <th>Transactions</th>
      <th>Name</th>
      <th>Donations</th>
    </tr>
  </thead>

  <tbody>
    <%  Contributor.all.each do |contributor| %>
      <tr>
        <td><%= contributor.transactions.count %></td>
        <td><%= link_to "#{contributor.first_name} #{contributor.last_name}", contributor %></td>
        <td><%= number_to_currency(contributor.transactions.sum(:amount)) %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<script>

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "currency-pre": function ( a ) {
        a = (a==="-") ? 0 : a.replace( /[^\d\-\.]/g, "" );
        return parseFloat( a );
    },
 
    "currency-asc": function ( a, b ) {
        return a - b;
    },
 
    "currency-desc": function ( a, b ) {
        return b - a;
    }
} );

$(document).ready(function () {
    $('#contributors').DataTable({
        order: [[2, 'desc']],
        columnDefs: [
       { type: 'currency', targets: 2 }
     ],
    });
});
</script>
